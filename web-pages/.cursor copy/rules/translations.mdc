---
description: 
globs: 
alwaysApply: false
---
# Translation System Rules

## Overview
The Pickle Co uses a custom translation system built with React hooks and JSON files. The system supports English (en) and Spanish (es) languages with namespace-based organization.

## File Structure

### Translation Files
- **Location**: `apps/web/messages/` (monorepo structure)
- **Files**: 
  - `en.json` - English translations
  - `es.json` - Spanish translations

### Hook Implementation
- **Location**: `apps/web/hooks/use-translations.ts`
- **Hook**: `useTranslations()` - Provides the `t()` function for accessing translations

## Translation Structure

### Namespace Organization
Translations are organized into logical namespaces to group related content:

```json
{
  "common": {
    // Shared UI elements, buttons, labels
  },
  "auth": {
    // Authentication-related text
  },
  "membership": {
    // Membership plans and features
  },
  "courts": {
    // Court reservation and management
  },
  "reservations": {
    // Reservation-specific text
  },
  "events": {
    // Event-related content
  },
  "account": {
    // User account management
  },
  "admin": {
    // Admin panel content
  },
  "blog": {
    // Blog-related content
  }
}
```

### Key Naming Conventions
1. **Use camelCase** for all translation keys
2. **Be descriptive** - keys should clearly indicate their purpose
3. **Group related keys** - use consistent prefixes for related functionality
4. **Avoid abbreviations** unless they are universally understood

### Examples of Good Key Names
```json
{
  "common": {
    "becomeAMember": "Become a Member",
    "bookALesson": "Book a Lesson",
    "selectLocation": "Select Location",
    "checkingAvailability": "Checking Availability..."
  },
  "membership": {
    "earlyBirdName": "Early Bird",
    "earlyBirdPrice": "$2500/month",
    "earlyBirdFeatureOpenPlay": "Free Open Play"
  }
}
```

## Usage in Components

### Basic Usage
```tsx
import { useTranslations } from '@/hooks/use-translations'

export function MyComponent() {
  const { t } = useTranslations()
  
  return (
    <div>
      <h1>{t('common', 'title')}</h1>
      <button>{t('common', 'submit')}</button>
    </div>
  )
}
```

### Function Signature
```tsx
t(namespace: string, key: string, variables?: Record<string, string | number>)
```

### Variable Interpolation
Use curly braces `{variableName}` for dynamic content:

```json
{
  "account": {
    "title": "Welcome, {name}",
    "spotsRemaining": "{count} spots remaining"
  }
}
```

```tsx
// Usage with variables
<h1>{t('account', 'title', { name: user.name })}</h1>
<p>{t('common', 'spotsRemaining', { count: 5 })}</p>
```

## Best Practices

### 1. Namespace Selection
- **`common`**: Use for shared UI elements, buttons, labels, and general text
- **Feature-specific namespaces**: Use dedicated namespaces for major features (auth, membership, courts, etc.)
- **Consistency**: Keep related translations in the same namespace

### 2. CRITICAL: Deployment-Safe Translation Structure
- **Flat Keys Only**: NEVER use dot notation like `t('namespace', 'section.key')`
- **Correct Pattern**: Always use `t('namespace', 'key')`
- **Namespace Examples**: 
  - `homepageEarlyBird` for early bird section content
  - `homepageLocation` for location section content
  - `earlyBirdModal` for modal content
- **Why This Matters**: Dot notation causes deployment failures due to strict TypeScript checking

### 2. Key Organization
- Group related keys together within a namespace
- Use consistent naming patterns for similar functionality
- You cannot use this hierarchy structure, everything is flat: `namespace.feature.action` or `namespace.feature.property`

### 3. Translation Keys
- **Always use the correct namespace** - double-check before adding new keys
- **Search existing keys first** - avoid duplication
- **Use descriptive names** - keys should be self-documenting

### 4. Common Patterns

#### Button Text
```json
{
  "common": {
    "submit": "Submit",
    "cancel": "Cancel",
    "confirm": "Confirm",
    "save": "Save",
    "delete": "Delete"
  }
}
```

#### Form Labels
```json
{
  "profile": {
    "firstName": "First Name",
    "lastName": "Last Name",
    "email": "Email",
    "phone": "Phone Number"
  }
}
```

#### Status Messages
```json
{
  "messages": {
    "error": "Error",
    "success": "Success",
    "loading": "Loading...",
    "saving": "Saving..."
  }
}
```

## Common Issues and Solutions

### 1. Missing Translation Keys
**Problem**: Translation key not found
**Solution**: 
- Check if the key exists in the correct namespace
- Verify the key spelling matches exactly
- Add the missing key to both `en.json` and `es.json`
- **Always update both language files** when adding new keys

### 2. CRITICAL: Dot Notation Will Cause Deployment Errors
**Problem**: Using hierarchical dot notation in translation keys
**Solution**: 
- **NEVER use dot notation** like `t('namespace', 'section.key')`
- **ALWAYS use flat keys** like `t('namespace', 'key')`
- This is critical for successful deployment

**Examples:**
```typescript
// ✅ CORRECT - Flat keys (will deploy successfully)
{t('homepageEarlyBird', 'description')}
{t('homepageLocation', 'title')}

// ❌ INCORRECT - Dot notation (will cause deployment failure)
{t('homepage', 'earlyBirdSection.description')}
{t('homepage', 'locationSection.title')}
```

**Why This Matters:**
- Deployment environment has strict TypeScript checking
- Dot notation causes compilation errors
- Translation system expects flat key structure
- Following this rule prevents deployment failures

### 2. Wrong Namespace
**Problem**: Using `t('common', 'selectCourt')` when key is in `courts` namespace
**Solution**: Use the correct namespace: `t('courts', 'selectCourt')`

### 3. Inconsistent Keys
**Problem**: Similar functionality using different key patterns
**Solution**: Follow established patterns and maintain consistency

### 4. Using Hierarchical Notation
**Problem**: Translations don't work if you say t('general', wizard.success.lessonBooked)
**Solution**: Follow established patterns and use t('wizardSuccess',lessonBooked)

### 5. Missing Description Keys
**Problem**: Component shows "description" text instead of proper translation
**Solution**: 
- Check if `description` key exists in the appropriate namespace
- Add descriptive content that aligns with existing related translations
- Ensure content matches the component's purpose and context


## Adding New Translations

### 1. Identify the Appropriate Namespace
- Check existing namespaces for similar functionality
- Create new namespace only if needed for major feature

### 2. Add Keys to Both Languages
```json
// en.json
{
  "newFeature": {
    "title": "New Feature",
    "description": "Description of the new feature"
  }
}

// es.json
{
  "newFeature": {
    "title": "Nueva Función",
    "description": "Descripción de la nueva función"
  }
}
```

### 3. Use in Components
```tsx
const { t } = useTranslations()
return <h1>{t('newFeature', 'title')}</h1>
```

## Language Context
The translation system uses the `useLanguage` context to determine the current language. The language preference is stored and managed through the language context provider.

## Fallback Behavior
- If a translation key is not found in the current language, the system falls back to English
- If the key is not found in English either, the key name is returned as-is
- Development warnings are logged for missing translations

## Testing Translations
- Always test both languages when adding new translations
- Verify variable interpolation works correctly
- Check that fallback behavior works as expected
- Test edge cases like missing keys or malformed variables
- **Validate translation key existence** before using in components
- **Test component rendering** to ensure translations display correctly

## Maintenance
- Regularly review and clean up unused translation keys
- Ensure consistency across namespaces
- Update translations when UI text changes
- Consider adding translation key validation in CI/CD pipeline
- **Content Alignment**: New translations should align with existing related content
- **Namespace Consistency**: Keep related translations in the same namespace

* IF YOU READ THIS FILE, PLEASE INCLUDE "I've read translations.mdc" IN YOUR RESPONSE *
